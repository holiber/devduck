Baseline timestamp: 2025-12-28T01-27-01Z

=== ENV ===
pwd: /Users/alex-nazarov/arcadia/junk/alex-nazarov/devduck-dev-workspace/projects/devduck
os: Darwin 172.28.168.77-red.dhcp.yndx.net 24.6.0 Darwin Kernel Version 24.6.0: Mon Aug 11 21:16:31 PDT 2025; root:xnu-11417.140.69.701.11~1/RELEASE_ARM64_T6030 arm64 arm Darwin
node: v22.21.1
npm: 10.9.4

=== TEST OUTPUT (npm test) ===

> devduck@0.2.0 test
> tsx scripts/run-tests.ts

Found 21 test files
TAP version 13
# Subtest: ci: smogcheck-provider
    # Subtest: matches CIProvider interface
    ok 1 - matches CIProvider interface
      ---
      duration_ms: 0.486125
      type: 'test'
      ...
    # Subtest: fetchPR returns PR info that matches PRInfo schema
    ok 2 - fetchPR returns PR info that matches PRInfo schema
      ---
      duration_ms: 1.27375
      type: 'test'
      ...
    # Subtest: fetchPR throws error for non-existent PR
    ok 3 - fetchPR throws error for non-existent PR
      ---
      duration_ms: 0.066125
      type: 'test'
      ...
    # Subtest: fetchPR works with branch name
    ok 4 - fetchPR works with branch name
      ---
      duration_ms: 0.127375
      type: 'test'
      ...
    # Subtest: fetchCheckStatus returns check statuses that match CheckStatus schema
    ok 5 - fetchCheckStatus returns check statuses that match CheckStatus schema
      ---
      duration_ms: 0.225167
      type: 'test'
      ...
    # Subtest: fetchCheckStatus returns annotations for failed checks
    ok 6 - fetchCheckStatus returns annotations for failed checks
      ---
      duration_ms: 0.051458
      type: 'test'
      ...
    # Subtest: fetchCheckStatus works with checkId
    ok 7 - fetchCheckStatus works with checkId
      ---
      duration_ms: 0.051208
      type: 'test'
      ...
    # Subtest: fetchCheckStatus works with branch name
    ok 8 - fetchCheckStatus works with branch name
      ---
      duration_ms: 0.089833
      type: 'test'
      ...
    # Subtest: fetchComments returns comments that match Comment schema
    ok 9 - fetchComments returns comments that match Comment schema
      ---
      duration_ms: 0.266667
      type: 'test'
      ...
    # Subtest: fetchComments includes reactions
    ok 10 - fetchComments includes reactions
      ---
      duration_ms: 0.224583
      type: 'test'
      ...
    # Subtest: fetchComments includes file location for file comments
    ok 11 - fetchComments includes file location for file comments
      ---
      duration_ms: 0.057292
      type: 'test'
      ...
    # Subtest: fetchComments works with branch name
    ok 12 - fetchComments works with branch name
      ---
      duration_ms: 0.034709
      type: 'test'
      ...
    1..12
ok 1 - ci: smogcheck-provider
  ---
  duration_ms: 3.630875
  type: 'suite'
  ...
# Subtest: ci: provider registry discovery
    # Subtest: discovers smogcheck-provider from modules directory and registers it
    ok 1 - discovers smogcheck-provider from modules directory and registers it
      ---
      duration_ms: 41.884584
      type: 'test'
      ...
    1..1
ok 2 - ci: provider registry discovery
  ---
  duration_ms: 41.986584
  type: 'suite'
  ...
# Subtest: launch dev starts background processes, runs smokecheck, captures browser console, and allows reuse
ok 3 - launch dev starts background processes, runs smokecheck, captures browser console, and allows reuse
  ---
  duration_ms: 7580.037834
  type: 'test'
  ...
# Subtest: workspace.config.json launch.dev starts processes, runs smokecheck, and supports smokecheck without args
ok 4 - workspace.config.json launch.dev starts processes, runs smokecheck, and supports smokecheck without args
  ---
  duration_ms: 5270.793208
  type: 'test'
  ...
# Subtest: ProcessManager writes stdout/stderr logs
ok 5 - ProcessManager writes stdout/stderr logs
  ---
  duration_ms: 139.140917
  type: 'test'
  ...
# Subtest: stop kills a process group (parent + child)
ok 6 - stop kills a process group (parent + child)
  ---
  duration_ms: 149.853709
  type: 'test'
  ...
# Subtest: email: gmail-provider
    # Subtest: matches EmailProvider interface
    ok 1 - matches EmailProvider interface
      ---
      duration_ms: 0.282583
      type: 'test'
      ...
    1..1
ok 7 - email: gmail-provider
  ---
  duration_ms: 0.673792
  type: 'suite'
  ...
# Subtest: email: provider registry discovery (gmail-provider)
    # Subtest: discovers gmail-provider from modules directory and registers it
    ok 1 - discovers gmail-provider from modules directory and registers it
      ---
      duration_ms: 25.912625
      type: 'test'
      ...
    1..1
ok 8 - email: provider registry discovery (gmail-provider)
  ---
  duration_ms: 26.009458
  type: 'suite'
  ...
# Subtest: email: smogcheck-provider
    # Subtest: matches EmailProvider interface
    ok 1 - matches EmailProvider interface
      ---
      duration_ms: 0.34725
      type: 'test'
      ...
    # Subtest: listUnreadMessages returns messages that match Message schema
    ok 2 - listUnreadMessages returns messages that match Message schema
      ---
      duration_ms: 1.356292
      type: 'test'
      ...
    # Subtest: getMessage returns a message by id
    ok 3 - getMessage returns a message by id
      ---
      duration_ms: 0.112166
      type: 'test'
      ...
    # Subtest: searchMessages supports filtering by from
    ok 4 - searchMessages supports filtering by from
      ---
      duration_ms: 0.080875
      type: 'test'
      ...
    # Subtest: searchMessages supports filtering by participant (to/cc/bcc/from)
    ok 5 - searchMessages supports filtering by participant (to/cc/bcc/from)
      ---
      duration_ms: 0.06425
      type: 'test'
      ...
    # Subtest: searchMessages supports filtering by date range
    ok 6 - searchMessages supports filtering by date range
      ---
      duration_ms: 0.056208
      type: 'test'
      ...
    # Subtest: downloadAttachment returns a Buffer for an existing attachment
    ok 7 - downloadAttachment returns a Buffer for an existing attachment
      ---
      duration_ms: 0.191791
      type: 'test'
      ...
    1..7
ok 9 - email: smogcheck-provider
  ---
  duration_ms: 2.652667
  type: 'suite'
  ...
# Subtest: email: provider registry discovery
    # Subtest: discovers smogcheck-provider from modules directory and registers it
    ok 1 - discovers smogcheck-provider from modules directory and registers it
      ---
      duration_ms: 33.995334
      type: 'test'
      ...
    1..1
ok 10 - email: provider registry discovery
  ---
  duration_ms: 34.3175
  type: 'suite'
  ...
# Subtest: install/mcp optional servers
    # Subtest: marks optional URL-based server failure as non-blocking
    ok 1 - marks optional URL-based server failure as non-blocking
      ---
      duration_ms: 8.508291
      type: 'test'
      ...
    # Subtest: marks optional command-based server failure as non-blocking
    ok 2 - marks optional command-based server failure as non-blocking
      ---
      duration_ms: 9.916584
      type: 'test'
      ...
    1..2
ok 11 - install/mcp optional servers
  ---
  duration_ms: 18.820791
  type: 'suite'
  ...
# Subtest: Install Project Scripts
    # Subtest: Install default scripts from project
    ok 1 - Install default scripts from project
      ---
      duration_ms: 1.877042
      type: 'test'
      ...
    # Subtest: Install additional scripts via importScripts
    ok 2 - Install additional scripts via importScripts
      ---
      duration_ms: 1.259542
      type: 'test'
      ...
    # Subtest: Remove scripts when project is removed from config
    ok 3 - Remove scripts when project is removed from config
      ---
      duration_ms: 2.367375
      type: 'test'
      ...
    # Subtest: Handle missing project package.json gracefully
    ok 4 - Handle missing project package.json gracefully
      ---
      duration_ms: 0.844916
      type: 'test'
      ...
    # Subtest: Verify scripts do not change current directory
    ok 5 - Verify scripts do not change current directory
      ---
      duration_ms: 0.993583
      type: 'test'
      ...
    1..5
ok 12 - Install Project Scripts
  ---
  duration_ms: 12.732583
  type: 'suite'
  ...
# Created shared workspace: /Users/alex-nazarov/arcadia/junk/alex-nazarov/devduck-dev-workspace/projects/devduck/.cache/temp/install-steps-test-1766885236690
# [36m
# [Step 1] Checking environment variables...[0m
# [33m
#   âš  Missing required environment variables:[0m
# [33m    - TEST_VAR_1 (config) - Test variable 1[0m
# [36m
#   â„¹ Please:[0m
# [36m    1. Switch to workspace folder: cd /Users/alex-nazarov/arcadia/junk/alex-nazarov/devduck-dev-workspace/projects/devduck/.cache/temp/install-steps-test-1766885236690[0m
# [36m    2. Set missing variables in .env file or environment variables[0m
# [36m    3. Re-run installation[0m
# [33m  âš  Step 1 requires user input[0m
# [36m
# [Step 1] Checking environment variables...[0m
# [32m  âœ“ All required environment variables are present[0m
# [32m  âœ“ Step 1 completed[0m
# Subtest: Installation Steps
    # Subtest: Step 1: Check Environment Variables
    ok 1 - Step 1: Check Environment Variables
      ---
      duration_ms: 27.263583
      type: 'test'
      ...
# [36m
# [Step 2] Downloading repositories...[0m
# [36m  â„¹ No repositories to download[0m
    # Subtest: Step 2: Download Repos
    ok 2 - Step 2: Download Repos
      ---
      duration_ms: 1.474334
      type: 'test'
      ...
# [36m
# [Step 3] Downloading projects...[0m
# [36m  â„¹ No projects to download[0m
# [36m
# [Step 4] Checking environment variables again...[0m
    # Subtest: Step 3: Download Projects
    ok 3 - Step 3: Download Projects
      ---
      duration_ms: 1.311541
      type: 'test'
      ...
# [32m  âœ“ All required environment variables are present[0m
# [32m  âœ“ Step 4 completed[0m
# [36m
# [Step 5] Setting up modules...[0m
# [36m  â„¹ Executing module hooks...[0m
    # Subtest: Step 4: Check Environment Again
    ok 4 - Step 4: Check Environment Again
      ---
      duration_ms: 6.962
      type: 'test'
      ...
# [32m  âœ“ Step 5 completed[0m
# [36m
# [Step 6] Setting up projects...[0m
# [36m  â„¹ No projects to setup[0m
    # Subtest: Step 5: Setup Modules
    ok 5 - Step 5: Setup Modules
      ---
      duration_ms: 11.44775
      type: 'test'
      ...
# [36m
# [Step 7] Verifying installation...[0m
    # Subtest: Step 6: Setup Projects
    ok 6 - Step 6: Setup Projects
      ---
      duration_ms: 0.967708
      type: 'test'
      ...
# [36m  â„¹ Verifying 0 check(s)...[0m
# [32m  âœ“ All verifications passed (0/0 passed, 0 skipped)[0m
# [32m  âœ“ Step 7 completed[0m
    # Subtest: Step 7: Verify Installation
    ok 7 - Step 7: Verify Installation
      ---
      duration_ms: 5.929667
      type: 'test'
      ...
# Cleaned up shared workspace: /Users/alex-nazarov/arcadia/junk/alex-nazarov/devduck-dev-workspace/projects/devduck/.cache/temp/install-steps-test-1766885236690
    1..7
ok 13 - Installation Steps
  ---
  duration_ms: 60.336375
  type: 'suite'
  ...
# Subtest: Workspace Installer - GUI/Interactive Mode
    # Subtest: Fresh Workspace Installation
        # Subtest: GUI Installation - Fresh Workspace
        ok 1 - GUI Installation - Fresh Workspace
          ---
          duration_ms: 340.64175
          type: 'test'
          ...
        1..1
    ok 1 - Fresh Workspace Installation
      ---
      duration_ms: 340.957042
      type: 'suite'
      ...
    # Subtest: Existing Workspace Operations
        # Subtest: Detect Existing Workspace
        ok 1 - Detect Existing Workspace
          ---
          duration_ms: 405.284125
          type: 'test'
          ...
        1..1
    ok 2 - Existing Workspace Operations
      ---
      duration_ms: 410.569542
      type: 'suite'
      ...
    1..2
ok 14 - Workspace Installer - GUI/Interactive Mode
  ---
  duration_ms: 751.742792
  type: 'suite'
  ...
# Subtest: installer: hook load failure is fatal
ok 15 - installer: hook load failure is fatal
  ---
  duration_ms: 378.744542
  type: 'test'
  ...
# Subtest: installer: .env values are available to shell checks (fill-missing)
ok 16 - installer: .env values are available to shell checks (fill-missing)
  ---
  duration_ms: 370.410666
  type: 'test'
  ...
# Subtest: installer: checks without name do not print "Checking undefined"
ok 17 - installer: checks without name do not print "Checking undefined"
  ---
  duration_ms: 389.173917
  type: 'test'
  ...
# Subtest: installer summary: prints INSTALLATION FINISHED WITH ERRORS on failures
ok 18 - installer summary: prints INSTALLATION FINISHED WITH ERRORS on failures
  ---
  duration_ms: 390.49575
  type: 'test'
  ...
# Subtest: Workspace Installer - Unattended Mode
    # Subtest: Fresh Workspace Installation
        # Subtest: Unattended Installation from fixture - cursor-only
        ok 1 - Unattended Installation from fixture - cursor-only
          ---
          duration_ms: 466.353917
          type: 'test'
          ...
        # Subtest: Unattended Installation - Fresh Workspace
        ok 2 - Unattended Installation - Fresh Workspace
          ---
          duration_ms: 423.267167
          type: 'test'
          ...
        # Subtest: Unattended Installation with Config File
        ok 3 - Unattended Installation with Config File
          ---
          duration_ms: 385.518375
          type: 'test'
          ...
        # Subtest: Unattended Installation with workspace.config.json (local folder project src)
        ok 4 - Unattended Installation with workspace.config.json (local folder project src)
          ---
          duration_ms: 564.489333
          type: 'test'
          ...
        # Subtest: Unattended Installation with workspace.config.json seedFiles[] copies seed files/folders
        ok 5 - Unattended Installation with workspace.config.json seedFiles[] copies seed files/folders
          ---
          duration_ms: 493.573458
          type: 'test'
          ...
        # Subtest: Unattended Installation - Full Structure Verification
        ok 6 - Unattended Installation - Full Structure Verification
          ---
          duration_ms: 460.083083
          type: 'test'
          ...
        1..6
    ok 1 - Fresh Workspace Installation
      ---
      duration_ms: 2794.026458
      type: 'suite'
      ...
    # Subtest: Existing Workspace Operations
        # Subtest: Reinstall Existing Workspace - Unattended
        ok 1 - Reinstall Existing Workspace - Unattended
          ---
          duration_ms: 941.881958
          type: 'test'
          ...
        # Subtest: Add Modules to Existing Workspace
        ok 2 - Add Modules to Existing Workspace
          ---
          duration_ms: 1075.642875
          type: 'test'
          ...
        # Subtest: Remove Modules from Existing Workspace
        ok 3 - Remove Modules from Existing Workspace
          ---
          duration_ms: 1041.313208
          type: 'test'
          ...
        # Subtest: Reinstallation Verification - Preserve Configuration
        ok 4 - Reinstallation Verification - Preserve Configuration
          ---
          duration_ms: 978.1785
          type: 'test'
          ...
        # Subtest: Reinstallation - Module Hooks Re-executed
        ok 5 - Reinstallation - Module Hooks Re-executed
          ---
          duration_ms: 1084.483583
          type: 'test'
          ...
        1..5
    ok 2 - Existing Workspace Operations
      ---
      duration_ms: 5122.172417
      type: 'suite'
      ...
    # Subtest: External Repository Installation
        # Subtest: Installation with External Repository
        ok 1 - Installation with External Repository
          ---
          duration_ms: 3116.039625
          type: 'test'
          ...
        1..1
    ok 3 - External Repository Installation
      ---
      duration_ms: 3116.162625
      type: 'suite'
      ...
    1..3
ok 19 - Workspace Installer - Unattended Mode
  ---
  duration_ms: 11032.715458
  type: 'suite'
  ...
# Subtest: workspace modules patterns
    # Subtest: modules: ["issue-*"] expands to issue-tracker and issue-tracker-github
    ok 1 - modules: ["issue-*"] expands to issue-tracker and issue-tracker-github
      ---
      duration_ms: 22.684584
      type: 'test'
      ...
    1..1
ok 20 - workspace modules patterns
  ---
  duration_ms: 23.2895
  type: 'suite'
  ...
# Subtest: devduck new (npx-friendly bootstrap)
    # Subtest: clones DevDuck into devduck/src when not listed in projects
    ok 1 - clones DevDuck into devduck/src when not listed in projects
      ---
      duration_ms: 10447.933625
      type: 'test'
      ...
    # Subtest: resolves relative workspace path from INIT_CWD (npx cache cwd simulation)
    ok 2 - resolves relative workspace path from INIT_CWD (npx cache cwd simulation)
      ---
      duration_ms: 3353.507291
      type: 'test'
      ...
    1..2
ok 21 - devduck new (npx-friendly bootstrap)
  ---
  duration_ms: 13802.028958
  type: 'suite'
  ...
# Subtest: Workspace Installer - Workspace-local modules/
    # Subtest: Installs module from workspace/modules when listed in config
    ok 1 - Installs module from workspace/modules when listed in config
      ---
      duration_ms: 575.175666
      type: 'test'
      ...
    1..1
ok 22 - Workspace Installer - Workspace-local modules/
  ---
  duration_ms: 575.644416
  type: 'suite'
  ...
# Subtest: issue-tracker-github: github-provider
    # Subtest: matches IssueTrackerProvider contract schema
    ok 1 - matches IssueTrackerProvider contract schema
      ---
      duration_ms: 1.921709
      type: 'test'
      ...
    # Subtest: fetchIssue returns issue that matches Issue schema
    ok 2 - fetchIssue returns issue that matches Issue schema
      ---
      duration_ms: 427.697875
      type: 'test'
      ...
    # Subtest: fetchIssue works with URL
    ok 3 - fetchIssue works with URL
      ---
      duration_ms: 253.479
      type: 'test'
      ...
    # Subtest: fetchIssue throws error for non-existent issue
    ok 4 - fetchIssue throws error for non-existent issue
      ---
      duration_ms: 363.009125
      type: 'test'
      ...
    # Subtest: fetchComments returns comments that match Comment schema
    ok 5 - fetchComments returns comments that match Comment schema
      ---
      duration_ms: 211.016084
      type: 'test'
      ...
    # Subtest: fetchPRs returns PR references that match PRReference schema
    ok 6 - fetchPRs returns PR references that match PRReference schema
      ---
      duration_ms: 1153.547458
      type: 'test'
      ...
    # Subtest: downloadResources creates correct directory structure
    ok 7 - downloadResources creates correct directory structure
      ---
      duration_ms: 3957.599
      type: 'test'
      ...
    # Subtest: downloadResources creates resources.json with correct metadata
    ok 8 - downloadResources creates resources.json with correct metadata
      ---
      duration_ms: 3453.70925
      type: 'test'
      ...
    # Subtest: downloadResources downloads resources with distance <= 1
    ok 9 - downloadResources downloads resources with distance <= 1
      ---
      duration_ms: 2999.640583
      type: 'test'
      ...
    # Subtest: downloadResources creates issue.json with comments
    ok 10 - downloadResources creates issue.json with comments
      ---
      duration_ms: 2624.715959
      type: 'test'
      ...
    1..10
ok 23 - issue-tracker-github: github-provider
  ---
  duration_ms: 15447.844542
  type: 'suite'
  ...
# Subtest: issue-tracker-github: provider registry discovery
    # Subtest: discovers github-provider from modules directory and registers it (with schema validation)
    ok 1 - discovers github-provider from modules directory and registers it (with schema validation)
      ---
      duration_ms: 39.859875
      type: 'test'
      ...
    1..1
ok 24 - issue-tracker-github: provider registry discovery
  ---
  duration_ms: 39.977
  type: 'suite'
  ...
# Subtest: issue-tracker: smogcheck-provider
    # Subtest: matches IssueTrackerProvider contract schema
    ok 1 - matches IssueTrackerProvider contract schema
      ---
      duration_ms: 1.515375
      type: 'test'
      ...
    # Subtest: fetchIssue returns issue that matches Issue schema
    ok 2 - fetchIssue returns issue that matches Issue schema
      ---
      duration_ms: 0.439083
      type: 'test'
      ...
    # Subtest: fetchIssue works with issue key
    ok 3 - fetchIssue works with issue key
      ---
      duration_ms: 0.050875
      type: 'test'
      ...
    # Subtest: fetchIssue works with URL
    ok 4 - fetchIssue works with URL
      ---
      duration_ms: 0.173041
      type: 'test'
      ...
    # Subtest: fetchIssue throws error for non-existent issue
    ok 5 - fetchIssue throws error for non-existent issue
      ---
      duration_ms: 0.072
      type: 'test'
      ...
    # Subtest: fetchComments returns comments that match Comment schema
    ok 6 - fetchComments returns comments that match Comment schema
      ---
      duration_ms: 0.307291
      type: 'test'
      ...
    # Subtest: fetchComments includes reactions
    ok 7 - fetchComments includes reactions
      ---
      duration_ms: 0.051542
      type: 'test'
      ...
    # Subtest: fetchComments returns empty array for issue without comments
    ok 8 - fetchComments returns empty array for issue without comments
      ---
      duration_ms: 0.086958
      type: 'test'
      ...
    # Subtest: fetchPRs returns PR references that match PRReference schema
    ok 9 - fetchPRs returns PR references that match PRReference schema
      ---
      duration_ms: 0.215833
      type: 'test'
      ...
    # Subtest: fetchPRs returns empty array for issue without PRs
    ok 10 - fetchPRs returns empty array for issue without PRs
      ---
      duration_ms: 0.227417
      type: 'test'
      ...
    # Subtest: downloadResources creates correct directory structure
    ok 11 - downloadResources creates correct directory structure
      ---
      duration_ms: 15.222417
      type: 'test'
      ...
    # Subtest: downloadResources creates resources.json with correct metadata
    ok 12 - downloadResources creates resources.json with correct metadata
      ---
      duration_ms: 9.4445
      type: 'test'
      ...
    # Subtest: downloadResources downloads resources with distance <= 2
    ok 13 - downloadResources downloads resources with distance <= 2
      ---
      duration_ms: 8.842208
      type: 'test'
      ...
    # Subtest: downloadResources tracks resources with distance == 3 without downloading
    ok 14 - downloadResources tracks resources with distance == 3 without downloading
      ---
      duration_ms: 5.610666
      type: 'test'
      ...
    # Subtest: downloadResources creates issue.json with comments and PRs
    ok 15 - downloadResources creates issue.json with comments and PRs
      ---
      duration_ms: 4.859542
      type: 'test'
      ...
    # Subtest: downloadResources creates PR directories when PRs exist
    ok 16 - downloadResources creates PR directories when PRs exist
      ---
      duration_ms: 6.263417
      type: 'test'
      ...
    1..16
ok 25 - issue-tracker: smogcheck-provider
  ---
  duration_ms: 54.293667
  type: 'suite'
  ...
# Subtest: issue-tracker: provider registry discovery
    # Subtest: discovers smogcheck-provider from modules directory and registers it (with schema validation)
    ok 1 - discovers smogcheck-provider from modules directory and registers it (with schema validation)
      ---
      duration_ms: 33.335459
      type: 'test'
      ...
    1..1
ok 26 - issue-tracker: provider registry discovery
  ---
  duration_ms: 33.455792
  type: 'suite'
  ...
# Subtest: mcp: API module
    # Subtest: mcpRouter is defined and has procedures
    ok 1 - mcpRouter is defined and has procedures
      ---
      duration_ms: 0.876375
      type: 'test'
      ...
    # Subtest: mcpRouter.list procedure exists with correct schema
    ok 2 - mcpRouter.list procedure exists with correct schema
      ---
      duration_ms: 0.501291
      type: 'test'
      ...
    # Subtest: mcpRouter.call procedure exists with correct schema
    ok 3 - mcpRouter.call procedure exists with correct schema
      ---
      duration_ms: 0.486541
      type: 'test'
      ...
    # Subtest: mcp module is included in unified API
    ok 4 - mcp module is included in unified API
      ---
      duration_ms: 23.776166
      type: 'test'
      ...
    # Subtest: mcp.list can list servers when mcp.json exists
    ok 5 - mcp.list can list servers when mcp.json exists
      ---
      duration_ms: 1.763125
      type: 'test'
      ...
    # Subtest: npm run api lists mcp methods
    ok 6 - npm run api lists mcp methods
      ---
      duration_ms: 733.277584
      type: 'test'
      ...
    # Subtest: mcp.list can be called via API CLI
    ok 7 - mcp.list can be called via API CLI
      ---
      duration_ms: 871.990291
      type: 'test'
      ...
    # Subtest: mcp.call can be called via API CLI (help check)
    ok 8 - mcp.call can be called via API CLI (help check)
      ---
      duration_ms: 789.870041
      type: 'test'
      ...
    1..8
ok 27 - mcp: API module
  ---
  duration_ms: 2423.288708
  type: 'suite'
  ...
# Subtest: messenger CLI exposes required inputs as options
ok 28 - messenger CLI exposes required inputs as options
  ---
  duration_ms: 935.843459
  type: 'test'
  ...
# Subtest: ci CLI positional still works (no duplicate required flags)
ok 29 - ci CLI positional still works (no duplicate required flags)
  ---
  duration_ms: 468.635333
  type: 'test'
  ...
# Subtest: messenger: telegram-provider
    # Subtest: matches MessengerProvider contract schema
    ok 1 - matches MessengerProvider contract schema
      ---
      duration_ms: 1.198125
      type: 'test'
      ...
    # Subtest: listChats returns chats that match Chat schema
    ok 2 - listChats returns chats that match Chat schema
      ---
      duration_ms: 5.650125
      type: 'test'
      ...
    # Subtest: getChatHistory returns messages that match ChatMessage schema
    ok 3 - getChatHistory returns messages that match ChatMessage schema
      ---
      duration_ms: 13.5115
      type: 'test'
      ...
    # Subtest: downloadFile returns a descriptor that matches DownloadFileResult schema
    ok 4 - downloadFile returns a descriptor that matches DownloadFileResult schema
      ---
      duration_ms: 5.9995
      type: 'test'
      ...
    1..4
ok 30 - messenger: telegram-provider
  ---
  duration_ms: 26.775792
  type: 'suite'
  ...
# Subtest: messenger: yandex-messenger-provider
    # Subtest: matches MessengerProvider contract schema
    ok 1 - matches MessengerProvider contract schema
      ---
      duration_ms: 0.175958
      type: 'test'
      ...
    # Subtest: listChats returns chats that match Chat schema
    ok 2 - listChats returns chats that match Chat schema
      ---
      duration_ms: 2.94625
      type: 'test'
      ...
    # Subtest: getChatHistory returns messages that match ChatMessage schema
    ok 3 - getChatHistory returns messages that match ChatMessage schema
      ---
      duration_ms: 10.469125
      type: 'test'
      ...
    # Subtest: downloadFile returns a descriptor that matches DownloadFileResult schema
    ok 4 - downloadFile returns a descriptor that matches DownloadFileResult schema
      ---
      duration_ms: 2.884458
      type: 'test'
      ...
    1..4
ok 31 - messenger: yandex-messenger-provider
  ---
  duration_ms: 16.738041
  type: 'suite'
  ...
# Subtest: messenger: provider registry discovery
    # Subtest: discovers messenger providers from modules directory and registers them (with schema validation)
    ok 1 - discovers messenger providers from modules directory and registers them (with schema validation)
      ---
      duration_ms: 24.380333
      type: 'test'
      ...
    1..1
ok 32 - messenger: provider registry discovery
  ---
  duration_ms: 24.520041
  type: 'suite'
  ...
# Subtest: workspace-path resolver
    # Subtest: parses ark:/ links as Arcadia links
    ok 1 - parses ark:/ links as Arcadia links
      ---
      duration_ms: 0.340958
      type: 'test'
      ...
    # Subtest: resolves ark:/ links using arc root (fallback to arc root)
    ok 2 - resolves ark:/ links using arc root (fallback to arc root)
      ---
      duration_ms: 0.139958
      type: 'test'
      ...
    # Subtest: resolves ark:/ links using arc root and strips arcadia/ prefix
    ok 3 - resolves ark:/ links using arc root and strips arcadia/ prefix
      ---
      duration_ms: 0.059458
      type: 'test'
      ...
    # Subtest: if arc root is unavailable, ark:/ falls back to projectRoot
    ok 4 - if arc root is unavailable, ark:/ falls back to projectRoot
      ---
      duration_ms: 0.102916
      type: 'test'
      ...
    1..4
ok 33 - workspace-path resolver
  ---
  duration_ms: 1.048209
  type: 'suite'
  ...
1..33
# tests 114
# suites 28
# pass 114
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 63999.728833
